<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waren Sardne</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>
</head>
<body style="text-align: center;">

<header>
    <img src="file.jpg" alt="Header Image" class="header-image">
    <h1>Waren Sardne</h1>
</header>

<main>
    <h3 style="font-family: 'ModernTypewriter', sans-serif;">Arkiv over forskjellige Waren Sardne aviser.</h3>
    <p style="font-family: 'ModernTypewriter', sans-serif;">Dette er en oversikt over 5 forskjellige aviser fra Waren Sardne. Trykk på bilde av avisen og bla ned, da kan du lese gjennom den valgte avisen.</p>

    <!-- Archive Section -->
    <section id="archive" class="centered">
        <div id="archiveItems">
            <div class="archive-item">
                <div class="archive-content">
                    <div class="title">Lørdag 15. januar 1910</div>
                    <div class="description">Dette er første utgaven av avisen Waren Sardne.</div>
                </div>
                <div class="image-overlay">
                    <img src="Bilde_2024-09-10_195743723.png" data-pdf="2024-09-10T1646_NB_generated.pdf" alt="First Edition Thumbnail" class="archive-image">
                </div>
            </div>
            <div class="archive-item">
                <div class="archive-content">
                    <div class="title">Lørdag 12. November 1910</div>
                </div>
                <div class="image-overlay">
                    <img src="Bilde_2024-09-10_195708388.png" data-pdf="2024-09-10T1650_NB_generated.pdf" alt="Item 2 Picture" class="archive-image">
                </div>
            </div>
            <div class="archive-item">
                <div class="archive-content">
                    <div class="title">Fredag 20. Oktober 1922</div>
                </div>
                <div class="image-overlay">
                    <img src="Bilde_2024-09-10_195631608.png" data-pdf="2024-09-10T1652_NB_generated.pdf" alt="Item 3 Picture" class="archive-image">
                </div>
            </div>
            <div class="archive-item">
                <div class="archive-content">
                    <div class="title">Torsdag 20. juli 1922</div>
                </div>
                <div class="image-overlay">
                    <img src="Bilde_2024-09-10_195537839.png" data-pdf="2024-09-10T1654_NB_generated.pdf" alt="Item 4 Picture" class="archive-image">
                </div>
            </div>
            <div class="archive-item">
                <div class="archive-content">
                    <div class="title">Lørdag 1. Oktober 1927</div>
                    <div class="description">Dette eksemplaret av Waren Sardne er en av de siste utgitte.</div>
                </div>
                <div class="image-overlay">
                    <img src="Bilde_2024-09-10_195425696.png" data-pdf="2024-09-10T1656_NB_generated.pdf" alt="Item 5 Picture" class="archive-image">
                </div>
            </div>
        </div>
    </section>
    
    <div id="pdfViewer" class="centered hidden" style="display: flex; flex-direction: column; align-items: center;">
        <span class="close-button" onclick="closePDFViewer()"></span>
        <div class="centered-content" style="width: 100%; display: flex; flex-direction: column; align-items: center;">
            <canvas id="pdfCanvas" style="width:80%; height:1000px;"></canvas>
            <!-- Ensure controls are centered below the PDF -->
            <div class="pdf-controls" style="margin-top: 20px; text-align: center;">
                <button id="prevPage">Forrige side</button>
                <span id="pageInfo">Side <span id="currentPage">1</span> av <span id="totalPages">--</span></span>
                <button id="nextPage">Neste side</button>
            </div>
        </div>            
    </div>
    
  
        </div>            
    </div>
    
    <button id="closeButton">Avslutt</button>
</main>

<footer>
    <p>&copy; Waren Sardne 2024</p>
</footer>

<script>
    let pdfDoc = null,
        currentPage = 1,
        totalPages = 0,
        pdfCanvas = document.getElementById('pdfCanvas'),
        ctx = pdfCanvas.getContext('2d');

    function renderPage(pageNum) {
        pdfDoc.getPage(pageNum).then(function(page) {
            const scale = 1.5;
            const viewport = page.getViewport({ scale: scale });

            pdfCanvas.height = viewport.height;
            pdfCanvas.width = viewport.width;

            const renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };
            page.render(renderContext);

            document.getElementById('currentPage').textContent = pageNum;
        });
    }

    function queueRenderPage(pageNum) {
        if (pageNum >= 1 && pageNum <= totalPages) {
            renderPage(pageNum);
        }
    }

    function nextPage() {
        if (currentPage < totalPages) {
            currentPage++;
            queueRenderPage(currentPage);
        }
    }

    function prevPage() {
        if (currentPage > 1) {
            currentPage--;
            queueRenderPage(currentPage);
        }
    }

    window.onload = function() {
        const pdfViewer = document.getElementById('pdfViewer');
        pdfViewer.classList.add('hidden'); // Ensure it's hidden

        const archiveImages = document.querySelectorAll('.archive-image');

        // Handle click events for archive images
        archiveImages.forEach(image => {
            image.addEventListener('click', () => {
                const pdfSrc = image.getAttribute('data-pdf');
                if (pdfSrc) {
                    // Load and render the PDF file using PDF.js
                    const loadingTask = pdfjsLib.getDocument(pdfSrc);
                    loadingTask.promise.then(pdf => {
                        pdfDoc = pdf;
                        totalPages = pdf.numPages;
                        document.getElementById('totalPages').textContent = totalPages;
                        currentPage = 1; // Reset to page 1
                        renderPage(currentPage);

                        pdfViewer.classList.remove('hidden'); // Show the PDF viewer
                    }).catch(error => {
                        console.error('Error loading PDF:', error);
                    });
                } else {
                    console.error('No PDF source found for this image.');
                }
            });
        });

        // Attach next and previous page buttons
        document.getElementById('nextPage').addEventListener('click', nextPage);
        document.getElementById('prevPage').addEventListener('click', prevPage);

        // Function to close the PDF viewer
        window.closePDFViewer = function() {
            pdfViewer.classList.add('hidden'); // Hide the viewer when the close button is clicked
            ctx.clearRect(0, 0, pdfCanvas.width, pdfCanvas.height); // Clear the canvas
        };

        // Attach close button to the function
        document.getElementById('closeButton').addEventListener('click', closePDFViewer);
    };



    
</script>

</body>
</html>
